!function(e){var t,n=document;(t=function(e,o){e=t.element(e),t.on(e,"change",function(r){var a=new FileReader,i=new Image,c=n.createElement("div"),p=n.createElement("canvas"),s=p.getContext("2d"),l=n.documentElement.clientWidth,d=n.documentElement.clientHeight,h="";a.readAsDataURL(e.files[0]),c.style.cssText="width:"+l+"px;height:"+d+"px;",c.className="cropper",l=l>640?640:l,p.width=o.size||l,p.height=o.size||l,p.className="cropper-canvas",h+='<div class="cropper-view" style="width:'+l+"px;height:"+l+"px;margin:-"+l/2+"px 0 0 -"+l/2+'px;"></div>',h+='<div class="cropper-btn"><a class="cropper-btn-cancel" href="javascript:void(0);">取消</a>',h+='<a class="cropper-btn-ok" href="javascript:void(0);">截取</a></div></div>',t.on(c,"touchstart touchmove touchend",function(e){e.preventDefault()}),a.onload=function(){i.src=a.result},i.onload=function(){var n=i.width,r=i.height,m=(n>r?n/r:1)*l,u=n>r?(d-l)/2:0,v=n>r?l/r*-n/2+l/2:0;h='<div class="cropper-container cropper-anime-middle"><img class="cropper-img" src="'+a.result+'" width="'+m+'" style="top:'+u+"px;left:"+v+'px;" />'+h,c.innerHTML=h,t.element("body").appendChild(c);var g=t.element(".cropper"),f=t.element(".cropper-container"),w=t.element(".cropper-view"),y=t.element(".cropper-img"),b=t.element(".cropper-btn-cancel"),x=t.element(".cropper-btn-ok"),E=1,N=void 0,T=void 0,C=void 0,X=void 0,B=void 0,L=void 0,A=void 0,D=v,U=u;setTimeout(function(){f.className="cropper-container cropper-anime-middle translateY"},0),t.on(w,"touchstart touchmove touchend",function(e){var t=e.targetTouches[0],n=e.targetTouches[1],o=e.touches.length;if("touchstart"==e.type&&(2===o?(N=Math.abs(t.pageX-n.pageX),C=!1):1===o&&(X=t.pageX,L=t.pageY,C=!0)),"touchmove"==e.type&&(2===o?(T=E+(Math.abs(t.pageX-n.pageX)-N)/l,y.style.width=T*m+"px",C=!1):1===o&&(B=t.pageX-X,A=t.pageY-L,y.style.left=B+D+"px",y.style.top=A+U+"px",C=!0)),"touchend"==e.type){if(y.className="cropper-img cropper-anime",C){D=B+D,U=A+U;var r=-y.width+l;D=D>0?0:D<r?r:D;var a=(d-l)/2,i=d-(y.height+a);U=U>a?a:U<i?i:U,y.style.left=D+"px",y.style.top=U+"px"}else E=T>1?T:1,y.style.width=E*m+"px";setTimeout(function(){y.className="cropper-img"},200)}e.preventDefault()}),t.on(b,"touchend",function(){f.className="cropper-container cropper-anime-middle",e.value=null,setTimeout(function(){t.element("body").removeChild(g)},350)}),t.on(x,"touchend",function(){if(Uint8Array&&atob&&Blob){var e=(o.size||l)/l;s.drawImage(i,0,0,n,r,D,U-(d-l)/2,y.width*e,y.height*e);var t=p.toDataURL();g.appendChild(p),t=t.split(",")[1],t=window.atob(t);for(var a=new Uint8Array(t.length),c=0;c<t.length;c++)a[c]=t.charCodeAt(c);o.success(new Blob([a],{type:"image/png"}))}else alert("Your browser doesn't support it")})}})}).element=function(e){return/^\./.test(e)?1==(e=n.getElementsByClassName(e.substr(1))).length?e[0]:e:/^#/.test(e)?n.getElementById(e.substr(1)):1==(e=n.getElementsByTagName(e)).length?e[0]:e},t.on=function(e,t,n,o){t=t.split(" ");for(var r=0;r<t.length;r++)window.addEventListener?e.addEventListener(t[r],n,o||!1):e.attachEvent("on"+t[r],n)},e.cropper=t}(window);